<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="HandheldFriendly" content="true">
    <meta charset="UTF-8">
    <meta name="keywords" content="生物医学图像处理">
    <meta name="description" content="7 图像复原 - 生物医学图像处理">
    <meta name="author" content="MingXiao">
    <title>7 图像复原</title>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="/assets/css/global.css">
    <link rel="stylesheet" href="/assets/css/pace-theme-flash.css">
    <link rel="stylesheet" href="/assets/css/d-audio.css">
    <link rel="stylesheet" href="/assets/css/article-detail.css">
    <link rel="stylesheet" href="/assets/css/code.css">
    <link rel="stylesheet" href="/assets/css/github-markdown.css">
    <link rel="stylesheet" href="/assets/css/vditor.css">
    <link rel="stylesheet" href="/assets/css/markdown.css">
    <link rel="shortcut icon" href="/images/blog-logo.png">
    <style>
        .lazy-image {
            background: url('/images/loading.gif') no-repeat center;
            background-size: 26% 35%;
            height: 100%;
            width: 100%;
        }

        .markdown-body {
            box-sizing: border-box;
            min-width: 200px;
            max-width: 980px;
            margin: 0 auto;
            padding: 10px;
        }

        @media (max-width: 767px) {
            .markdown-body {
                padding: 15px;
            }

            .markdown-body h1 {
                font-size: 1.35em;
            }

        }

        .codehilite {
            border-radius: 10px;
        }

        .article-content img {
            max-width: 100%;
        }

        #outerdiv {
            width: 100%;
            height: 100%;
            position: fixed;
            top: 0;
            left: 0;
            background: rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 200;
        }
    </style>
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <script src="/assets/js/include.js"></script>
    <div data-include="/includes/nav.html"></div>
        <div class="toc">
            <ul>
                <li>7 图像复原
                    <ul>
                            <li><a href="#6.1">7.1 图像退化模型</a></li>
                            <li><a href="#6.2">7.2 常见噪声模型</a></li>
                            <li><a href="#6.3">7.3 噪声处理</a></li>
                            <li><a href="#6.4">7.4 估计退化函数</a></li>
                            <li><a href="#6.5">7.5 图像复原方法</a></li>
                            <li><a href="#6.6">7.6 图像复原的质量评价</a></li>
                    </ul>
                </li>
            </ul>
        </div>

    <!--主体-->
    <section class="main">
        <div class="left-box">
            <div id="outerdiv">
                <div id="innerdiv" style="position:absolute;"><img alt id="bigimg"
                        style="box-shadow: 0 0 10px rgba(0,0,0,0.38)" src="" /></div>
            </div>
            <!--文章内容-->
            <div class="article-container">
                <div class="article-content markdown-body">
                    <h1 style="margin: 10px 0">7 图像复原</h1>
                    <div class="article-cate">
                        <a href="/Category/LearningHomepage.html">学习笔记</a>
                    </div>
                    <div class="writer-info">
                        <span style="margin: 5px 0;">作者: </span>
                        <span id="writer">MingXiao</span>
                    </div>
                    <div class="typora-export os-windows">
<p>图像增强是主观的，提高图像的可懂性；图像复原是客观的，提高图像的保真度</p>
<a name="6.1" class="md-header-anchor" id="6.1"></a>
<h3>7.1 图像退化模型</h3>
<p><strong>图像退化的因素</strong></p>
<ul>
<li>噪声干扰：在采集过程中的噪声，或者探测器损坏</li>
<li>运动模糊：被采集物体运动产生的模糊，运动伪影</li>
<li>几何失真：由于成像过程的系统非线性造成</li>
<li>辐射失真：传输介质的不均一，如大气湍流等</li>
<li>成像系统的像差、畸变、带宽有限等</li>
<li>灰度失真：系统本身的亮度响应不均匀，同亮度的灰度不同</li>
</ul>
<p>一般是非线性的</p>
<p>建立图像退化模型是复原的第一步，大致如下</p>
<center><img src="/Category/Learning/Pictures/ImgProcessing_65.png" width="500"></center>

<p>得到退化图像为<br>\[
g(x,y) = f(x,y)*h(x,y) + \eta(x,y) \\
G(\mu,\nu) = F(\mu,\nu)\cdot H(\mu,\nu) + \Eta(\mu,\nu)
\]<br>其中\(\Eta\)是大写的\(\eta\)</p>
<a name="6.2" class="md-header-anchor" id="6.2"></a>
<h3>7.2 常见噪声模型</h3>
<h4>7.2.1 高斯噪声</h4>
<p><strong>来源</strong></p>
<ul>
<li>视场不够明亮，亮度不均匀</li>
<li>元件自身的热噪声</li>
<li>长期工作的高温，产生噪声</li>
</ul>
<p><strong>分布</strong><br>\[
p(z) = \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(z-\mu)^2}{2\sigma^2}}
\]<br>其中\(z\)是灰度值，均值为0的噪声（\(\mu = 0\)）又称白噪声</p>
<h4>7.2.2 瑞利噪声</h4>
<p><strong>来源</strong>：平坦衰落信号的接收包络或是多路径分量的接收包络（雷达）</p>
<p><strong>分布</strong><br>\[
p(z) = \begin{cases}
\frac{2}{b}(z-a)e^{-\frac{(z-a)^2}{b}} , \,\,\,\, z\geq a\\
0\,\,\,\,\,\,\,\,\,,o.w.
\end{cases}
\]<br>均值和方差为<br>\[
\mu = a+\sqrt{\frac{\pi b}{4}}\\
\sigma^2 = \frac{b(4-\pi)}{4}
\]</p>
<h4>7.2.3 γ噪声</h4>
<p><strong>来源</strong>：激光成像的噪声，pet等</p>
<p><strong>分布</strong><br>\[
p(z) = \begin{cases}
\frac{a^bz^{b-1}}{(b-1)!}e^{-az},\,\,\,\,z\geq 0\\
0  ,\,\,\,\,\,\,\,\,\,  o.w.
\end{cases}
\]<br>均值和方差为<br>\[
\mu = \frac{b}{a}\\
\sigma^2 = \frac{b}{a^2}
\]</p>
<p>其中\(a>0, b\in \Z^+\)，<strong>当\(b=1\)时，退化为指数分布</strong></p>
<h4>7.2.4 均匀分布噪声</h4>
<p><strong>来源</strong>：一定范围内的模拟输入被量化为一个数字输入，如果模拟信号的幅值时随机的，那么量化误差是均匀分布的</p>
<p><strong>分布</strong><br>\[
p(z) = \begin{cases}
\frac{1}{b-a} ,\,\,\, a\leq z \leq b\\
0,\,\,\,\,\, o.w.
\end{cases}
\]<br>均值和方差为<br>\[
\mu = \frac{a+b}{2}\\
\sigma^2 = \frac{(b-a)^2}{12}
\]</p>
<h4>7.2.5 脉冲噪声（椒盐噪声）</h4>
<p><strong>来源</strong>：受到强烈的脉冲信号干扰</p>
<p><strong>分布</strong><br>\[
p(z) = \sum P_i\delta(z-i)
\]<br>其中高灰度的噪声为盐噪声（白点），低灰度的噪声为胡椒噪声（黑点）</p>
<center><img src="/Category/Learning/Pictures/ImgProcessing_66.png" width="600"></center>



<h4>7.2.6 周期噪声</h4>
<p><strong>来源</strong>：由于电气或电机干扰产生，是一种空间依赖型噪声，可以通过频域滤波显著减少</p>
<center><img src="/Category/Learning/Pictures/ImgProcessing_67.png" width="500"></center>



<a name="6.3" class="md-header-anchor" id="6.3"></a>
<h3>7.3 噪声处理</h3>
<h4>7.3.1 噪声参数估计</h4>
<p>当只有加性噪声存在时，图像增强和图像复原几乎一致</p>
<p>根据直方图进行估计，但是要注意不能找边界处进行直方图处理</p>
<center><img src="/Category/Learning/Pictures/ImgProcessing_68.png" width="500"></center>



<h4>7.3.2 均值滤波器</h4>
<p>算数均值就是上面的平滑，不赘述</p>
<p><strong>几何均值滤波器</strong></p>
<p>利用邻域内的几何均值进行计算<br>\[
\hat{f}(x,y) = \left( \Pi g(s,t)\right)^\frac{1}{mn}
\]<br>但是需要注意，当邻域内存在0时，这个滤波器不好用</p>
<p>即对<strong>椒噪声不好用</strong></p>
<p><strong>谐波均值滤波器</strong></p>
<p>利用调和平均数进行计算<br>\[
\hat{f}(x,y) = \frac{mn}{\sum \frac{1}{g(x,y)}}
\]<br>这对高灰度的<strong>盐噪声很好</strong>，但是同样对<strong>胡椒噪声不好用</strong>；<strong>善于处理高斯噪声</strong></p>
<p><strong>逆谐波均值滤波器</strong><br>\[
\hat{f}(x,y) = \frac{\sum g(s,t)^{Q+1}}{\sum g(s,t)^Q}
\]<br>其中\(Q\)是滤波器的阶数</p>
<p>当\(Q>0\)时，善于处理胡椒噪声；当\(Q<0\)时，处理盐噪声；不能同时处理两种噪声</p>
<p>当\(Q=0\)时，退化为算术均值滤波器；当\(Q=-1\)时，退化为谐波均值滤波器</p>
<h4>7.3.3 统计排序滤波器</h4>
<p><strong>中值滤波</strong><br>\[
\hat{f}(x,y) = \mathsf{mid}\{g(s,t)\}
\]<br>对<strong>单极或双极脉冲噪声</strong>很有效</p>
<p><strong>最值滤波器</strong></p>
<p>分为最大/小值，在发现图像的亮/暗点有效，对胡椒/盐噪声有效</p>
<p><strong>中点滤波器</strong><br>\[
\hat{f}(x,y) = \frac{1}{2}\left(\max \{g(s,t)\} + \min \{g(s,t)\}\right)
\]<br>结合了排序和平均，对<strong>高斯</strong>和<strong>均匀</strong>噪声效果好</p>
<p><strong>修正的α均值滤波器</strong><br>\[
\hat{f}(x,y) = \frac{1}{mn-d} \sum g_d(s,t)
\]<br>其中\(f_d\)表示在邻域内分别去除\(d/2\)个最高和最低值后的集合</p>
<p>结合了中值和均值，对多种混合噪声的效果好，如高斯+椒盐</p>
<h4>7.3.4 自适应局部降噪滤波器</h4>
<p>可以根据局部的统计特征自动调整滤波效果<br>\[
\hat{f}(x,y) = g(x,y) - \frac{\sigma^2_\eta}{\sigma^2_L}[g(x,y)-m_L]
\]<br>其中\(\sigma_\eta^2,\sigma_L^2\)分别是整个图中的噪声方差和邻域内的灰度方差，\(m_L\)表示局部均值</p>
<p>分为以下几种情况</p>
<ul>
<li>\(\sigma^2_\eta=0\)，即没有噪声，那么\(\hat{f}=g\)</li>
<li>\(\sigma_L>>\sigma_\eta\)，那么这里是边界突变点，不能平滑，\(\hat{f}=g\)</li>
<li>\(\sigma_L\approx \sigma_\eta\)，那么这里是噪声，可以用普通的均值滤波，\(\hat{f}=m_L\)</li>
<li>\(\sigma_L<\sigma_\eta\)，根据加性噪声假设，令二者相等，\(\hat{f} = m_L\)</li>
</ul>
<h4>7.3.5 自适应中值滤波器</h4>
<p>中值滤波器的效果受窗口大小影响</p>
<p>小的窗口能保护细节，但是对噪声过滤不好，大的反之；且当噪声的数目多于正常像素数目，结果会是噪声</p>
<p>根据局部统计值动态调整<strong>窗口大小</strong></p>
<p>整个流程如下</p>
<center><img src="/Category/Learning/Pictures/ImgProcessing_69.png" width="600"></center>

<p>基本想法就是噪声不能是中值，所以判断条件没有\("="\)，还需要一个窗口的最大值作为限制</p>
<p>去噪的效果类似于中值，但是保留了很多细节</p>
<h4>7.3.6 频率域消除周期噪声</h4>
<p>由于周期噪声在频域内就是几个离散的点，可以使用带阻滤波器进行过滤</p>
<p>几个常用的<strong>带阻滤波器</strong></p>
<center><img src="/Category/Learning/Pictures/ImgProcessing_70.png" width="700"></center>

<p>如果使用\(H_p = 1-H_R\)得到带通滤波器</p>
<p>对同一幅图像进行处理，带通会得到周期性噪声，带阻得到去噪图像，因为是互补的</p>
<p>有时候周期噪声没有明显的频带，使用<strong>陷波滤波器</strong></p>
<p>陷波滤波器阻止/通过实现定义的中心频率的邻域内的信号</p>
<p>由于傅里叶变换的对称性，噪声信号应该是中心对称的，因此滤波器也需要中心对称</p>
<p>但是陷波区的形状和数目是任意的</p>
<center><img src="/Category/Learning/Pictures/ImgProcessing_71.png" width="300"></center>

 

<a name="6.4" class="md-header-anchor" id="6.4"></a>
<h3>7.4 估计退化函数</h3>
<p>找到退化函数\(H(\mu,\nu)\)是图像复原的关键，有以下方法</p>
<h4>7.4.1 图像观测估计法</h4>
<p>在图像没有明显噪声的地方进行取样，得到子图像\(g_s(x,y)\)，利用无噪声重建得到\(f_s(x,y)\)，那么退化函数为<br>\[
H(\mu,\nu) = \frac{G_s(\mu,\nu)}{F_s(\mu,\nu)}
\]</p>
<h4>7.4.2 实验估计法</h4>
<p>利用冲激函数，得到系统的冲激响应，做实验<br>\[
\delta(x,y) \rightarrow h(x,y) \Rightarrow1\rightarrow H(\mu,\nu)
\]</p>
<h4>7.4.3 模型估计法</h4>
<p>从引起图像退化的基本原理进行推导，根据先验的模型</p>
<p>例如，已知大气湍流函数为<br>\[
H(\mu,\nu) = e^{-k(\mu^2+\nu^2)^{5/6}}
\]<br>那么<br>\[
G = HF \Rightarrow F = H^{-1}G
\]<br><strong>运动伪影</strong></p>
<p>设\(x_0(t),y_0(t)\)是\(t\)时刻的位置分量，曝光时间为\(T\)的图像得到结果是<br>\[
g(x,y) = \int_0^T f(x-x_0(t),y-y_0(t)) dt
\]<br>两边DFT，由于积分不含位置项，等价于对\(f\)进行DFT，得到<br>\[
G = \int _0^T F \cdot e^{-j2\pi(\frac{\mu x_0(t)}{M}+\frac{\nu y_0(t)}{N})}dt
\]<br>那么系统函数就是<br>\[
H =\int _0^Te^{-j2\pi(\frac{\mu x_0(t)}{M}+\frac{\nu y_0(t)}{N})}dt
\]</p>
<a name="6.5" class="md-header-anchor" id="6.5"></a>
<h3>7.5 图像复原方法</h3>
<p>分为逆滤波和维纳滤波</p>
<h4>7.5.1 逆滤波</h4>
<p>\[
\hat{F} = \frac{G}{H} = F + \frac{\Eta}{H}
\]<br>当\(|H|\rightarrow 0\)时，噪音会变得很大，因此加入一个小的常数\(k\)，改写为<br>\[
\hat{F} = \frac{G}{H+k}
\]<br>逆滤波的问题在于<strong>完全没有考虑到噪声的统计特性</strong></p>
<h4>7.5.2 维纳滤波</h4>
<p>令<br>\[
\hat{F}(\mu,\nu) = H_{wie}(\mu,\nu) \cdot G(\mu,\nu)
\]<br>通过误差的最小二乘法得出\(H\)，即使得<br>\[
e^2 =\mathsf{E}\left(|F-\hat{F}|^2\right)
\]<br>最小的\(H\)，带入，得到<br>\[
H_{wie} = \frac{1}{H}\cdot \frac{|H|^2}{|H|^2+\frac{S_\eta}{S_f}}
\]<br>注意，这个结果的前提是<strong>噪声的均值为0且与图像独立</strong></p>
<p>其中\(S_\eta,S_f\)分别是噪声和原图的功率谱，有\(S_\eta(\mu,\nu)=\mathsf{E}\{ |\Eta(\mu,\nu)|^2 \}\)，\(S_f\)同理</p>
<p>当二者未知时，用\(K\)代替</p>
<a name="6.6" class="md-header-anchor" id="6.6"></a>
<h3>7.6 图像复原的质量评价</h3>
<p>有主观和客观，主观就是人看，客观就是与原图的误差的统计值，常用的统计值如下</p>
<center><img src="/Category/Learning/Pictures/ImgProcessing_72.png" width="300"></center>




                    </div>    
                </div>
            </div>                                                                                                                                              
            <br>
            <br>
            <h2 id="__comments">Comments</h2>
                  <!-- Giscus comments -->
                    <script src="https://giscus.app/client.js"
                            data-repo="MingX1ao/MingX1ao.github.io"
                            data-repo-id="R_kgDOL_cJHA"
                            data-category="General"
                            data-category-id="DIC_kwDOL_cJHM4CgVLq"
                            data-mapping="pathname"
                            data-strict="0"
                            data-reactions-enabled="1"
                            data-emit-metadata="0"
                            data-input-position="bottom"
                            data-theme="light"
                            data-lang="zh-CN"
                            data-loading="lazy"
                            crossorigin="anonymous"
                            async>
                    </script>
        </div>
    </section>
    <!--尾部-->
    <div data-include="/includes/footer.html"></div>
    <script>
        document.addEventListener('includesReady', function() {
            const lazyImage = new LazyImage('.lazy-image');
        });
    </script>
</body>

</html>
